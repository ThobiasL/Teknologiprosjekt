#!/bin/bash

# Finn roten til prosjektet
ROOT="$(dirname "$0")/.."
OUTPUT_DIR="$ROOT/charts"

# Sørg for at OUTPUT_DIR eksisterer
mkdir -p "$OUTPUT_DIR"

# Aktiver virtuelt miljø (hvis nødvendig)
source "$ROOT/.venv/bin/activate"

# Lag tilstandsdiagram
cat <<EOL > "$OUTPUT_DIR/state_diagram.dot"
digraph StateDiagram {
    rankdir=LR;
    size="8,5"

    node [shape = doublecircle]; Completed;
    node [shape = circle];

    Idle -> Processing [label = "Start"];
    Processing -> Completed [label = "Finish"];
    Completed -> Idle [label = "Reset"];
}
EOL

# Konverter til PNG
dot -Tpng "$OUTPUT_DIR/state_diagram.dot" -o "$OUTPUT_DIR/state_diagram.png"

# Konverter til SVG
dot -Tsvg "$OUTPUT_DIR/state_diagram.dot" -o "$OUTPUT_DIR/state_diagram.svg"

echo "Tilstandsdiagram generert i $OUTPUT_DIR som state_diagram.png og state_diagram.svg."
